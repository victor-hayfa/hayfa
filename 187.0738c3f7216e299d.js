"use strict";(self.webpackChunkhayfa=self.webpackChunkhayfa||[]).push([[187],{9187:(at,C,s)=>{s.r(C),s.d(C,{StockModule:()=>nt});var m=s(6895),g=s(1635),l=s(7155),_=s(8739),p=s(6308),r=s(4006),u=s(5412),t=s(4650),S=s(7009),v=s(4313),y=s(4740),Z=s(3162),b=s(9549),x=s(4859),T=s(455),A=s(8796),h=s(1206);function F(e,i){1&e&&t._UZ(0,"mat-progress-bar",20)}function U(e,i){1&e&&(t.TgZ(0,"mat-label"),t._uU(1,"Escolha a imagem"),t.qZA())}let f=(()=>{class e{constructor(o,n,a,c,d,k){this.formBuilder=o,this._snackBar=n,this.stockResource=a,this.categoryStockResource=c,this.dialog=d,this.data=k,this.categoryStock=[],this.loading=!1,this.savedChange=!1,this.stock=this.data.stock}ngOnInit(){this.initForm(),this.populateForm(this.stock),this.downloadCategoryStock()}initForm(){this.form=this.formBuilder.group({image:[null],code:[null,r.kI.required],name:[null,r.kI.required],quantity:[null,r.kI.required],category_id:[null,r.kI.required],status:[!0]})}save(o){if(this.form.valid){this.loading=!0;const n=new FormData;n.append("image",this.selectedFile),n.append("name",this.form.value.name),n.append("code",this.form.value.code),n.append("quantity",this.form.value.quantity),n.append("category_id",this.form.value.category_id),n.append("status",this.form.value.status),this.stock?this.stockResource.update(this.stock.id,n).then(a=>{this.stock=a,this.savedChange=!0,this.openSnackBar("Salvo com sucesso!","Fechar","success"),o&&this.closeDialog()}).catch(a=>{this.openSnackBar(422==a.status?"Erro: J\xe1 existe um item com esse c\xf3digo.":"Erro ao salvar","Fechar","danger")}).finally(()=>{this.loading=!1}):this.stockResource.create(n).then(a=>{this.stock=a,this.savedChange=!0,this.openSnackBar("Salvo com sucesso!","Fechar","success"),o&&this.closeDialog()}).catch(a=>{this.openSnackBar(422==a.status?"Erro: J\xe1 existe um item com esse c\xf3digo.":"Erro ao salvar","Fechar","danger")}).finally(()=>{this.loading=!1})}}populateForm(o){console.log(o),this.form.patchValue(o)}openSnackBar(o,n,a){this._snackBar.open(o,n,{horizontalPosition:"right",verticalPosition:"bottom",duration:3e3,panelClass:"snackBar-"+a})}canSave(){return this.form.valid&&!this.loading}closeDialog(){this.savedChange?this.dialog.close(this.stock):this.dialog.close()}selectFile(o){this.selectedFile=o.target.files[0]}downloadCategoryStock(){this.loading=!0,this.categoryStockResource.list().then(o=>{this.categoryStock=o}).catch(o=>{this.openSnackBar("Erro ao listar","Fechar","danger"),console.log(o)}).finally(()=>{this.loading=!1})}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(r.qu),t.Y36(S.ux),t.Y36(v.J),t.Y36(y.$),t.Y36(u.so),t.Y36(u.WI))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-stocks-form"]],decls:40,vars:5,consts:[["enctype","multipart/form-data",3,"formGroup"],[1,"btn-close",3,"click"],["mat-dialog-title","","cdkDrag","","cdkDragRootElement",".cdk-overlay-pane","cdkDragHandle","",1,"dialog-header"],["mode","indeterminate",4,"ngIf"],[1,"dialog-body"],[1,"row"],[1,"mb-3","col-md-6"],[1,"form-label"],[2,"color","#EC0606DD"],["type","text","formControlName","code",1,"form-control"],["type","number","formControlName","quantity",1,"form-control"],[1,"mb-3"],["type","text","formControlName","name",1,"form-control"],[1,"mb-4"],["bindLabel","name","bindValue","id","type","select","formControlName","category_id",3,"items"],["type","file","accept","image/*",3,"change"],[1,"mb-3","mt-2"],["color","primary","formControlName","status"],[1,"dialog-footer"],["type","submit","mat-button","",1,"btn-save",3,"disabled","click"],["mode","indeterminate"]],template:function(o,n){1&o&&(t.TgZ(0,"form",0)(1,"div",1),t.NdJ("click",function(){return n.closeDialog()}),t.qZA(),t.TgZ(2,"div",2),t._uU(3),t.qZA(),t.YNc(4,F,1,0,"mat-progress-bar",3),t.TgZ(5,"div",4)(6,"div",5)(7,"div",6)(8,"label",7),t._uU(9,"C\xf3digo"),t.qZA(),t.TgZ(10,"span",8),t._uU(11," * "),t.qZA(),t._UZ(12,"input",9),t.qZA(),t.TgZ(13,"div",6)(14,"label",7),t._uU(15,"Quantidade"),t.qZA(),t.TgZ(16,"span",8),t._uU(17," * "),t.qZA(),t._UZ(18,"input",10),t.qZA()(),t.TgZ(19,"div",11)(20,"label",7),t._uU(21,"Nome"),t.qZA(),t.TgZ(22,"span",8),t._uU(23," * "),t.qZA(),t._UZ(24,"input",12),t.qZA(),t.TgZ(25,"div",13)(26,"label",7),t._uU(27,"Categoria"),t.qZA(),t.TgZ(28,"span",8),t._uU(29," * "),t.qZA(),t._UZ(30,"ng-select",14),t.qZA(),t.TgZ(31,"div",11),t.YNc(32,U,2,0,"ng-template"),t.TgZ(33,"input",15),t.NdJ("change",function(c){return n.selectFile(c)}),t.qZA()(),t.TgZ(34,"div",16)(35,"mat-slide-toggle",17),t._uU(36,"Status"),t.qZA()()(),t.TgZ(37,"div",18)(38,"button",19),t.NdJ("click",function(){return n.save(!0)}),t._uU(39,"Salvar e Fechar"),t.qZA()()()),2&o&&(t.Q6J("formGroup",n.form),t.xp6(3),t.Oqu(n.stock?"Editar Item":"Novo Item"),t.xp6(1),t.Q6J("ngIf",n.loading),t.xp6(26),t.Q6J("items",n.categoryStock),t.xp6(8),t.Q6J("disabled",!n.canSave()))},dependencies:[m.O5,Z.pW,b.hX,x.lW,r._Y,r.Fj,r.wV,r.JJ,r.JL,r.sg,r.u,u.uh,T.Rr,A.w9,h.Zt,h.Bh],styles:[".dialog-header[_ngcontent-%COMP%]{font-weight:400;font-size:18px;width:auto;border-bottom:1px solid #d9d9d9;padding:10px 15px;background-color:#f8f7f7;margin-bottom:0;height:50px;cursor:grab}.dialog-body[_ngcontent-%COMP%]{padding:20px;height:340px}.dialog-footer[_ngcontent-%COMP%]{border-top:1px solid #d9d9d9;background-color:#f8f7f7;height:60px}.btn-close[_ngcontent-%COMP%]{float:right;font-size:30px;margin-top:2px}"]}),e})();var N=s(5841),B=s(9019),D=s(2687),Y=s(4868),L=s(4144),J=s(266);function M(e,i){1&e&&t._UZ(0,"mat-progress-bar",25)}function q(e,i){1&e&&(t.TgZ(0,"th",26),t._uU(1," Imagem "),t.qZA())}function I(e,i){if(1&e){const o=t.EpF();t.TgZ(0,"td",27),t.NdJ("click",function(){const c=t.CHM(o).$implicit,d=t.oxw();return t.KtG(d.openImageDialog(c.image))}),t._UZ(1,"img",28),t.qZA()}if(2&e){const o=i.$implicit;t.xp6(1),t.Q6J("src",o.image,t.LSH)}}function O(e,i){1&e&&(t.TgZ(0,"th",26),t._uU(1," C\xf3digo "),t.qZA())}function w(e,i){if(1&e&&(t.TgZ(0,"td",29),t._uU(1),t.qZA()),2&e){const o=i.$implicit;t.xp6(1),t.hij(" ",o.code," ")}}function P(e,i){1&e&&(t.TgZ(0,"th",26),t._uU(1," Nome "),t.qZA())}function Q(e,i){if(1&e&&(t.TgZ(0,"td",29),t._uU(1),t.qZA()),2&e){const o=i.$implicit;t.xp6(1),t.hij(" ",o.name," ")}}function E(e,i){1&e&&(t.TgZ(0,"th",26),t._uU(1," Quantidade "),t.qZA())}function R(e,i){if(1&e&&(t.TgZ(0,"td",29),t._uU(1),t.qZA()),2&e){const o=i.$implicit;t.xp6(1),t.hij(" ",o.quantity," ")}}function z(e,i){1&e&&(t.TgZ(0,"th",26),t._uU(1," Status "),t.qZA())}function H(e,i){1&e&&(t.TgZ(0,"span",32),t._uU(1,"Ativo"),t.qZA())}function G(e,i){1&e&&(t.TgZ(0,"span",33),t._uU(1,"Inativo"),t.qZA())}function $(e,i){if(1&e&&(t.TgZ(0,"td",29),t.YNc(1,H,2,0,"span",30),t.YNc(2,G,2,0,"span",31),t.qZA()),2&e){const o=i.$implicit;t.xp6(1),t.Q6J("ngIf",o.status),t.xp6(1),t.Q6J("ngIf",!o.status)}}function j(e,i){1&e&&t._UZ(0,"th",34)}function W(e,i){if(1&e){const o=t.EpF();t.TgZ(0,"td",29)(1,"div",35)(2,"button",36),t.NdJ("click",function(){const c=t.CHM(o).$implicit,d=t.oxw();return t.KtG(d.openStockDialog(c))}),t._UZ(3,"i",37),t.qZA(),t.TgZ(4,"button",38),t.NdJ("click",function(){const c=t.CHM(o).$implicit,d=t.oxw();return t.KtG(d.delete(c.id))}),t._UZ(5,"i",39),t.qZA()()()}}function V(e,i){1&e&&t._UZ(0,"tr",40)}function K(e,i){1&e&&t._UZ(0,"tr",41)}const X=function(){return[25,50,100]},tt=[{path:"",component:(()=>{class e{constructor(o,n,a,c,d,k){this._liveAnnouncer=o,this.dialog=n,this._snackBar=a,this.router=c,this.dialogService=d,this.stockResource=k,this.loading=!1,this.stock=[],this.displayedColumns=["image","code","name","quantity","status","options"],this.dataSource=new l.by}ngOnInit(){this.downloadStocks(),this.downloadImage()}ngAfterViewInit(){this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator}applyFilter(o){this.dataSource.filter=o.target.value.trim().toLowerCase()}sortChange(o){this._liveAnnouncer.announce(o.direction?`Sorted ${o.direction}ending`:"Sorting cleared")}openStockDialog(o){this.dialog.open(f,{width:"600px",maxHeight:"100vh",panelClass:"dialog",autoFocus:!1,data:{stock:o}}).afterClosed().subscribe(a=>{a&&(this.downloadStocks(),this.downloadImage())})}openImageDialog(o){this.dialog.open(N.H,{maxWidth:"60vw",maxHeight:"80vh",panelClass:"dialog",data:{imageUrl:o}}).afterClosed().subscribe(a=>{a&&(this.downloadStocks(),this.downloadImage())})}downloadImage(){this.loading=!0,this.stockResource.list().then(o=>{o.forEach(n=>{n.image=B.N.apiBaseUrlPublic+n.image}),this.dataSource.data=o,this.status=o.status}).catch(o=>{this.openSnackBar("Erro ao listar","Fechar","danger"),console.log(o)}).finally(()=>{this.loading=!1})}downloadStocks(){this.loading=!0,this.stockResource.list().then(o=>{this.dataSource.data=o,this.status=o.status}).catch(o=>{this.openSnackBar("Erro ao listar","Fechar","danger"),console.log(o)}).finally(()=>{this.loading=!1})}delete(o){this.dialogService.openConfirmDialog("Excluir","Tem certeza que deseja excluir?").afterClosed().subscribe(n=>{n&&(this.loading=!0,this.stockResource.delete(o).then(()=>{this.downloadStocks(),this.openSnackBar("Exclu\xeddo com sucesso!","Fechar","success")}).catch(a=>{this.openSnackBar("Erro ao excluir","Fechar","danger"),console.log(a)}).finally(()=>{this.loading=!1}))})}openSnackBar(o,n,a){this._snackBar.open(o,n,{horizontalPosition:"right",verticalPosition:"bottom",duration:3e3,panelClass:"snackBar-"+a})}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(D.Kd),t.Y36(u.uw),t.Y36(S.ux),t.Y36(g.F0),t.Y36(Y.x),t.Y36(v.J))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-stocks-list"]],viewQuery:function(o,n){if(1&o&&(t.Gf(_.NW,5),t.Gf(p.YE,5)),2&o){let a;t.iGM(a=t.CRH())&&(n.paginator=a.first),t.iGM(a=t.CRH())&&(n.sort=a.first)}},features:[t._Bn([m.JJ])],decls:39,vars:6,consts:[["id","main",1,"main"],[1,"pagetitle"],[1,"border-loading"],["style","height: 3px; border-radius: 50px","color","accent","mode","indeterminate",4,"ngIf"],[1,"header-table"],[1,"d-flex","align-items-center","justify-content-between"],[1,"search_input_group","search-table","w-25","mt-4","mb-4"],[1,"mdi","mdi-magnify"],["matInput","","placeholder","Pesquisar",1,"search_input",3,"input"],["input",""],["mat-stroked-button","","type","button",1,"button-add",3,"click"],["mat-table","","matSort","",3,"dataSource","matSortChange"],["matColumnDef","image"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",3,"click",4,"matCellDef"],["matColumnDef","code"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","quantity"],["matColumnDef","status"],["matColumnDef","options"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"mat-paginator",3,"pageSizeOptions"],["color","accent","mode","indeterminate",2,"height","3px","border-radius","50px"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",3,"click"],["alt","Imagem",1,"zoom-image",3,"src"],["mat-cell",""],["class","badge bg-success",4,"ngIf"],["class","badge bg-danger",4,"ngIf"],[1,"badge","bg-success"],[1,"badge","bg-danger"],["mat-header-cell",""],[1,"mat-icon-no-color"],["matTooltip","Editar",1,"icons-options",3,"click"],[1,"mdi","mdi-square-edit-outline"],["matTooltip","Excluir",1,"icons-options",3,"click"],[1,"mdi","mdi-trash-can-outline"],["mat-header-row",""],["mat-row",""]],template:function(o,n){1&o&&(t.TgZ(0,"main",0)(1,"div",1)(2,"h1"),t._uU(3,"Estoque Geral"),t.qZA()(),t.TgZ(4,"div",2),t.YNc(5,M,1,0,"mat-progress-bar",3),t.qZA(),t.TgZ(6,"div",4)(7,"div",5)(8,"div",6),t._UZ(9,"i",7),t._uU(10,"\xa0 "),t.TgZ(11,"input",8,9),t.NdJ("input",function(c){return n.applyFilter(c)}),t.qZA()(),t.TgZ(13,"div")(14,"button",10),t.NdJ("click",function(){return n.openStockDialog()}),t._uU(15,"Adicionar"),t.qZA()()(),t.TgZ(16,"div")(17,"table",11),t.NdJ("matSortChange",function(c){return n.sortChange(c)}),t.ynx(18,12),t.YNc(19,q,2,0,"th",13),t.YNc(20,I,2,1,"td",14),t.BQk(),t.ynx(21,15),t.YNc(22,O,2,0,"th",13),t.YNc(23,w,2,1,"td",16),t.BQk(),t.ynx(24,17),t.YNc(25,P,2,0,"th",13),t.YNc(26,Q,2,1,"td",16),t.BQk(),t.ynx(27,18),t.YNc(28,E,2,0,"th",13),t.YNc(29,R,2,1,"td",16),t.BQk(),t.ynx(30,19),t.YNc(31,z,2,0,"th",13),t.YNc(32,$,3,2,"td",16),t.BQk(),t.ynx(33,20),t.YNc(34,j,1,0,"th",21),t.YNc(35,W,6,0,"td",16),t.BQk(),t.YNc(36,V,1,0,"tr",22),t.YNc(37,K,1,0,"tr",23),t.qZA(),t._UZ(38,"mat-paginator",24),t.qZA()()()),2&o&&(t.xp6(5),t.Q6J("ngIf",n.loading),t.xp6(12),t.Q6J("dataSource",n.dataSource),t.xp6(19),t.Q6J("matHeaderRowDef",n.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",n.displayedColumns),t.xp6(1),t.Q6J("pageSizeOptions",t.DdM(5,X)))},dependencies:[m.O5,_.NW,Z.pW,p.YE,p.nU,x.lW,L.Nt,J.gM,l.BZ,l.fO,l.as,l.w1,l.Dz,l.nj,l.ge,l.ev,l.XQ,l.Gk],styles:['table[_ngcontent-%COMP%]{width:100%}td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{width:18%}h1[_ngcontent-%COMP%]{margin-top:20px}.button-add[_ngcontent-%COMP%]{border-radius:10px;margin-right:20px;font-size:16px;background-color:#7048ef;color:#fff;display:flex;align-items:center}.mat-header-cell[_ngcontent-%COMP%]{color:#484848;background-color:#f8f7f7;font-size:15px;font-family:TT Commons DemiBold,sans-serif}th.mat-header-cell[_ngcontent-%COMP%]:last-of-type, td.mat-cell[_ngcontent-%COMP%]:last-of-type, td.mat-footer-cell[_ngcontent-%COMP%]:last-of-type{padding-right:0!important}.mdi-magnify[_ngcontent-%COMP%]:before{content:"\\f0349";font-size:smaller}.mat-paginator[_ngcontent-%COMP%]{background-color:#f8f7f7;border-radius:10px}.zoom-image[_ngcontent-%COMP%]{position:relative;display:inline-block;width:40px;height:40px;margin-top:5px;margin-bottom:5px;border-radius:10px;background-color:#eee;box-shadow:0 1px 2px #0000001a;transition:all .6s cubic-bezier(.165,.84,.44,1)}.zoom-image[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.zoom-image[_ngcontent-%COMP%]:hover:after{opacity:1}']}),e})()},{path:"new",component:f},{path:":id/edit",component:f}];let ot=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[g.Bz.forChild(tt),g.Bz]}),e})();var et=s(1108);let nt=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[m.ez,ot,et.m,h._t]}),e})()}}]);