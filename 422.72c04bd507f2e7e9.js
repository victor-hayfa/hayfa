"use strict";(self.webpackChunkhayfa=self.webpackChunkhayfa||[]).push([[422],{1422:(J,g,n)=>{n.r(g),n.d(g,{TaskModule:()=>P});var p=n(6895),h=n(1635),d=n(1206),l=n(4006),u=n(5412),t=n(4650),f=n(7009),k=n(9463),x=n(5687),v=n(3162),T=n(4859),b=n(455),C=n(8796);function Z(o,i){1&o&&t._UZ(0,"mat-progress-bar",15)}let m=(()=>{class o{constructor(e,a,s,r,c,S){this.formBuilder=e,this._snackBar=a,this.taskResource=s,this.userLevelResource=r,this.dialog=c,this.data=S,this.loading=!1,this.savedChange=!1,this.selectedUserLevels=[],this.userLevels=[],this.task=this.data.task}ngOnInit(){this.initForm(),this.populateForm(this.task),this.downloadUserLevel()}initForm(){let e=sessionStorage.getItem("account_id"),a=null!==e?parseInt(e):0;this.form=this.formBuilder.group({name:[null,l.kI.required],order:[1],levels:[[],l.kI.required],status:[!0],account_id:[a]})}save(e){if(this.form.valid){this.loading=!0;let a=this.form.value;this.task?this.taskResource.update(this.task.id,a).then(s=>{this.task=s,this.savedChange=!0,this.openSnackBar("Salvo com sucesso!","Fechar","success"),e&&this.closeDialog()}).catch(s=>{this.openSnackBar("Erro ao salvar","Fechar","danger")}).finally(()=>{this.loading=!1}):this.taskResource.create(a).then(s=>{this.task=s,this.savedChange=!0,this.openSnackBar("Salvo com sucesso!","Fechar","success"),e&&this.closeDialog()}).catch(s=>{this.openSnackBar("Erro ao salvar","Fechar","danger")}).finally(()=>{this.loading=!1})}}populateForm(e){this.form.patchValue(null==e?e:{name:e.name,levels:JSON.parse(e.levels)})}openSnackBar(e,a,s){this._snackBar.open(e,a,{horizontalPosition:"right",verticalPosition:"bottom",duration:3e3,panelClass:"snackBar-"+s})}canSave(){return this.form.valid&&!this.loading}closeDialog(){this.savedChange?this.dialog.close(this.task):this.dialog.close()}downloadUserLevel(){this.loading=!0,this.userLevelResource.listFilter().then(e=>{this.userLevels=e,this.selectedUserLevels=e}).catch(e=>{this.openSnackBar("Erro ao listar","Fechar","danger"),console.log(e)}).finally(()=>{this.loading=!1})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(l.qu),t.Y36(f.ux),t.Y36(k.x),t.Y36(x.p),t.Y36(u.so),t.Y36(u.WI))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-tasks-form"]],decls:24,vars:6,consts:[[3,"formGroup"],[1,"btn-close",3,"click"],["mat-dialog-title","","cdkDrag","","cdkDragRootElement",".cdk-overlay-pane","cdkDragHandle","",1,"dialog-header"],["mode","indeterminate",4,"ngIf"],[1,"dialog-body"],[1,"mb-3"],[1,"form-label"],[2,"color","#ec0606dd"],["type","text","formControlName","name",1,"form-control"],[1,"mb-4"],["bindLabel","name","bindValue","id","type","select","formControlName","levels",3,"items","multiple"],[1,"mb-3","mt-3"],["color","primary","formControlName","status"],[1,"dialog-footer"],["mat-button","",1,"btn-save",3,"disabled","click"],["mode","indeterminate"]],template:function(e,a){1&e&&(t.TgZ(0,"form",0)(1,"div",1),t.NdJ("click",function(){return a.closeDialog()}),t.qZA(),t.TgZ(2,"div",2),t._uU(3),t.qZA(),t.YNc(4,Z,1,0,"mat-progress-bar",3),t.TgZ(5,"div",4)(6,"div",5)(7,"label",6),t._uU(8,"Descri\xe7\xe3o da Tarefa"),t.qZA(),t.TgZ(9,"span",7),t._uU(10," * "),t.qZA(),t._UZ(11,"input",8),t.qZA(),t.TgZ(12,"div",9)(13,"label",6),t._uU(14,"N\xedvel"),t.qZA(),t.TgZ(15,"span",7),t._uU(16," * "),t.qZA(),t._UZ(17,"ng-select",10),t.qZA(),t.TgZ(18,"div",11)(19,"mat-slide-toggle",12),t._uU(20,"Status"),t.qZA()()(),t.TgZ(21,"div",13)(22,"button",14),t.NdJ("click",function(){return a.save(!0)}),t._uU(23," Salvar e Fechar "),t.qZA()()()),2&e&&(t.Q6J("formGroup",a.form),t.xp6(3),t.hij(" ",a.task?"Editar Tarefa":"Nova Tarefa"," "),t.xp6(1),t.Q6J("ngIf",a.loading),t.xp6(13),t.Q6J("items",a.userLevels)("multiple",!0),t.xp6(5),t.Q6J("disabled",!a.canSave()))},dependencies:[p.O5,v.pW,T.lW,l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u,u.uh,b.Rr,C.w9,d.Zt,d.Bh],styles:[".dialog-header[_ngcontent-%COMP%]{font-weight:400;font-size:18px;width:auto;border-bottom:1px solid #d9d9d9;padding:10px 15px;background-color:#f8f7f7;margin-bottom:0;height:50px;cursor:grab}.dialog-body[_ngcontent-%COMP%]{padding:20px;height:245px}.dialog-footer[_ngcontent-%COMP%]{border-top:1px solid #d9d9d9;background-color:#f8f7f7;height:60px}.btn-close[_ngcontent-%COMP%]{float:right;font-size:30px;margin-top:2px}"]}),o})();var _=n(4868),y=n(4144),F=n(3546);function L(o,i){1&o&&t._UZ(0,"mat-progress-bar",12)}function A(o,i){1&o&&(t.TgZ(0,"div",13),t._uU(1,"Voc\xea ainda n\xe3o cadastrou nenhuma tarefa."),t.qZA())}function M(o,i){1&o&&t._UZ(0,"div",22)}function O(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"div",14)(1,"mat-card",15),t.YNc(2,M,1,0,"div",16),t.TgZ(3,"div"),t._UZ(4,"i",17),t.TgZ(5,"span",18),t._uU(6),t.qZA()(),t.TgZ(7,"div"),t._UZ(8,"span",19),t.TgZ(9,"i",20),t.NdJ("click",function(){const r=t.CHM(e).$implicit,c=t.oxw();return t.KtG(c.openTaskDialog(r))}),t.qZA(),t.TgZ(10,"i",21),t.NdJ("click",function(){const r=t.CHM(e).$implicit,c=t.oxw();return t.KtG(c.delete(r.id))}),t.qZA()()()()}if(2&o){const e=i.$implicit;t.xp6(6),t.Oqu(e.name)}}const U=[{path:"",component:(()=>{class o{constructor(e,a,s,r){this.dialog=e,this._snackBar=a,this.taskResource=s,this.dialogService=r,this.tasks=[],this.filteredTasks=[],this.loading=!1}ngOnInit(){this.downloadTasks()}applyFilter(e){const a=e.target.value.trim().toLowerCase();this.filteredTasks=this.tasks.filter(s=>s.name.toLowerCase().includes(a))}drop(e){(0,d.bA)(this.tasks,e.previousIndex,e.currentIndex)}openTaskDialog(e){this.dialog.open(m,{panelClass:"dialog",autoFocus:!1,width:"550px",height:"355px",data:{task:e}}).afterClosed().subscribe(s=>{s&&this.downloadTasks()})}delete(e){this.dialogService.openConfirmDialog("Excluir","Tem certeza que deseja excluir?").afterClosed().subscribe(a=>{a&&(this.loading=!0,this.taskResource.delete(e).then(()=>{this.downloadTasks(),this.openSnackBar("Exclu\xeddo com sucesso!","Fechar","success")}).catch(s=>{this.openSnackBar("Erro ao excluir","Fechar","danger"),console.log(s)}).finally(()=>{this.loading=!1}))})}downloadTasks(){this.loading=!0,this.taskResource.list().then(e=>{this.filteredTasks=e,this.tasks=e}).catch(e=>{this.openSnackBar("Erro ao listar","Fechar","danger"),console.log(e)}).finally(()=>{this.loading=!1})}openSnackBar(e,a,s){this._snackBar.open(e,a,{horizontalPosition:"right",verticalPosition:"bottom",duration:3e3,panelClass:"snackBar-"+s})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(u.uw),t.Y36(f.ux),t.Y36(k.x),t.Y36(_.x))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-tasks-list"]],decls:17,vars:3,consts:[["id","main",1,"main"],[1,"pagetitle"],[1,"border-loading"],["style","height: 3px; border-radius: 50px","color","accent","mode","indeterminate",4,"ngIf"],[1,"d-flex","align-items-center","justify-content-between"],[1,"search_input_group","search-table","w-25","mt-4","mb-4"],[1,"mdi","mdi-magnify"],["matInput","","placeholder","Pesquisar",1,"search_input",3,"input"],["mat-stroked-button","","type","button",1,"button-add",3,"click"],["class","alert",4,"ngIf"],["cdkDropList","",3,"cdkDropListDropped"],["cdkDrag","",4,"ngFor","ngForOf"],["color","accent","mode","indeterminate",2,"height","3px","border-radius","50px"],[1,"alert"],["cdkDrag",""],[1,"custom-card"],["class","custom-placeholder-drag-and-drop",4,"cdkDragPlaceholder"],[1,"mdi","mdi-drag","mx-2","cursor-grab"],[2,"margin-left","10px"],[1,"spacer"],[1,"mdi","mdi-square-edit-outline","mx-2","icons-options",3,"click"],[1,"mdi","mdi-trash-can-outline","icons-options",3,"click"],[1,"custom-placeholder-drag-and-drop"]],template:function(e,a){1&e&&(t.TgZ(0,"main",0)(1,"div",1)(2,"h1"),t._uU(3,"Tarefas"),t.qZA()(),t.TgZ(4,"div",2),t.YNc(5,L,1,0,"mat-progress-bar",3),t.qZA(),t.TgZ(6,"div",4)(7,"div",5),t._UZ(8,"i",6),t._uU(9,"\xa0 "),t.TgZ(10,"input",7),t.NdJ("input",function(r){return a.applyFilter(r)}),t.qZA()(),t.TgZ(11,"div")(12,"button",8),t.NdJ("click",function(){return a.openTaskDialog()}),t._uU(13,"Adicionar"),t.qZA()()(),t.YNc(14,A,2,0,"div",9),t.TgZ(15,"div",10),t.NdJ("cdkDropListDropped",function(r){return a.drop(r)}),t.YNc(16,O,11,1,"div",11),t.qZA()()),2&e&&(t.xp6(5),t.Q6J("ngIf",a.loading),t.xp6(9),t.Q6J("ngIf",a.tasks&&0===a.tasks.length),t.xp6(2),t.Q6J("ngForOf",a.filteredTasks))},dependencies:[p.sg,p.O5,v.pW,T.lW,y.Nt,F.a8,d.Wj,d.Zt,d.Hk],styles:['h1[_ngcontent-%COMP%]{margin-top:20px}.search-table[_ngcontent-%COMP%]{margin:0;float:left}.button-add[_ngcontent-%COMP%]{border-radius:10px;font-size:16px;background-color:#7048ef;color:#fff;display:flex;align-items:center}.custom-card[_ngcontent-%COMP%]{margin-top:10px;margin-bottom:10px;box-shadow:0 0 30px #0129700d;border:2px dashed #e5e5e5;border-radius:10px;height:55px;display:flex;align-items:center;justify-content:space-between;border-left:5px solid #9696ff}.mdi-arrow-up-down[_ngcontent-%COMP%]:before{content:"\\f0e79";font-size:small}.mdi-trash-can-outline[_ngcontent-%COMP%]:hover{content:"\\f0a7a";color:#ec0606dd;cursor:pointer}.mdi-square-edit-outline[_ngcontent-%COMP%]:hover{content:"\\f090c";color:#000;cursor:pointer}.custom-placeholder-drag-and-drop[_ngcontent-%COMP%]{background:rgba(150,150,255,.13);border:dashed 2px #9696ff;min-height:55px;border-radius:10px;transition:transform .25s cubic-bezier(0,0,.2,1)}.spacer[_ngcontent-%COMP%]{flex-grow:1}.icons-options[_ngcontent-%COMP%]{background-color:transparent;border:none;font-size:17px;color:#6e6e6e}  .ng-dropdown-panel .ng-dropdown-panel-items{display:block;max-height:105px!important;box-sizing:border-box;overflow-y:auto}.cursor-grab[_ngcontent-%COMP%]{cursor:grab}.alert[_ngcontent-%COMP%]{margin-top:10px;margin-bottom:10px;box-shadow:0 0 30px #0129700d;border:2px dashed #e5e5e5;border-radius:10px;height:55px;display:flex;align-items:center;justify-content:center;background-color:#f8f8f8;font-size:15px}']}),o})()},{path:"new",component:m},{path:":id/edit",component:m}];let B=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[h.Bz.forChild(U),h.Bz]}),o})();var D=n(1108);let P=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[p.ez,B,D.m,d._t]}),o})()}}]);