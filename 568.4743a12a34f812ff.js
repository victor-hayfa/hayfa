"use strict";(self.webpackChunkhayfa=self.webpackChunkhayfa||[]).push([[568],{5568:(H,_,r)=>{r.r(_),r.d(_,{TasksPlanModule:()=>Q});var p=r(6895),h=r(1635),c=r(7155),x=r(8739),g=r(6308),d=r(4006),u=r(5412),t=r(4650),f=r(7009),k=r(662),v=r(9463),T=r(3162),b=r(4859),P=r(1206);function Z(n,s){1&n&&t._UZ(0,"mat-progress-bar",11)}let C=(()=>{class n{constructor(a,e,o,i,l,m){this.formBuilder=a,this._snackBar=e,this.taskPlanResource=o,this.taskResource=i,this.dialog=l,this.data=m,this.loading=!1,this.savedChange=!1,this.selectedTaskIds=[],this.tasks=[],this.taskPlan=this.data.taskPlan,this.copy=this.data.copy}ngOnInit(){this.initForm(),this.downloadTasks(),this.populateForm(this.taskPlan)}initForm(){this.form=this.formBuilder.group({name:[null,d.kI.required],tasks:this.formBuilder.array([])})}save(a){if(this.form.valid){this.loading=!0;let e=this.form.value;e.tasks=this.selectedTaskIds,this.taskPlan&&!this.copy?this.taskPlanResource.update(this.taskPlan.id,e).then(o=>{this.taskPlan=o,this.savedChange=!0,this.openSnackBar("Salvo com sucesso!","Fechar","success"),a&&this.closeDialog()}).catch(o=>{this.openSnackBar("Erro ao salvar","Fechar","danger")}).finally(()=>{this.loading=!1}):this.taskPlanResource.create(e).then(o=>{this.taskPlan=o,this.savedChange=!0,this.openSnackBar("Salvo com sucesso!","Fechar","success"),a&&this.closeDialog()}).catch(o=>{this.openSnackBar("Erro ao salvar","Fechar","danger")}).finally(()=>{this.loading=!1})}}populateForm(a){this.selectedTaskIds=[],this.form.patchValue({name:a.name}),this.selectedTaskIds=a.tasks}openSnackBar(a,e,o){this._snackBar.open(a,e,{horizontalPosition:"right",verticalPosition:"bottom",duration:3e3,panelClass:"snackBar-"+o})}closeDialog(){this.savedChange?this.dialog.close(this.taskPlan):this.dialog.close()}downloadTasks(){this.loading=!0,this.taskResource.list().then(a=>{this.tasks=a}).catch(a=>{this.openSnackBar("Erro ao listar","Fechar","danger")}).finally(()=>{this.loading=!1})}}return n.\u0275fac=function(a){return new(a||n)(t.Y36(d.qu),t.Y36(f.ux),t.Y36(k.X),t.Y36(v.x),t.Y36(u.so),t.Y36(u.WI))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-task-plan-form"]],decls:15,vars:3,consts:[[3,"formGroup"],[1,"btn-close",3,"click"],["mat-dialog-title","","cdkDrag","","cdkDragRootElement",".cdk-overlay-pane","cdkDragHandle","",1,"dialog-header"],["mode","indeterminate",4,"ngIf"],[1,"dialog-body"],[1,"mb-3"],[1,"form-label"],[2,"color","#EC0606DD"],["type","text","formControlName","name",1,"form-control"],[1,"dialog-footer"],["mat-button","",1,"btn-save",3,"click"],["mode","indeterminate"]],template:function(a,e){1&a&&(t.TgZ(0,"form",0)(1,"div",1),t.NdJ("click",function(){return e.closeDialog()}),t.qZA(),t.TgZ(2,"div",2),t._uU(3),t.qZA(),t.YNc(4,Z,1,0,"mat-progress-bar",3),t.TgZ(5,"div",4)(6,"div",5)(7,"label",6),t._uU(8,"Nome do Plano de Tarefas"),t.qZA(),t.TgZ(9,"span",7),t._uU(10," * "),t.qZA(),t._UZ(11,"input",8),t.qZA()(),t.TgZ(12,"div",9)(13,"button",10),t.NdJ("click",function(){return e.save(!0)}),t._uU(14,"Salvar e Fechar"),t.qZA()()()),2&a&&(t.Q6J("formGroup",e.form),t.xp6(3),t.hij(" ",e.taskPlan&&e.copy?"Duplicar Plano de Tarefas":e.taskPlan&&!e.copy?"Editar Plano de Tarefas":"Novo Plano de Tarefas"," "),t.xp6(1),t.Q6J("ngIf",e.loading))},dependencies:[p.O5,T.pW,b.lW,d._Y,d.Fj,d.JJ,d.JL,d.sg,d.u,u.uh,P.Zt,P.Bh],styles:[".dialog-header[_ngcontent-%COMP%]{font-weight:400;font-size:18px;width:auto;border-bottom:1px solid #d9d9d9;padding:10px 15px;background-color:#f8f7f7;margin-bottom:0;height:50px;cursor:grab}.dialog-body[_ngcontent-%COMP%]{padding:20px;height:120px}.dialog-footer[_ngcontent-%COMP%]{border-top:1px solid #d9d9d9;background-color:#f8f7f7;height:60px}.btn-close[_ngcontent-%COMP%]{float:right;font-size:30px;margin-top:2px}"]}),n})();var F=r(2687),D=r(4868),y=r(4144),B=r(266);function S(n,s){1&n&&t._UZ(0,"mat-progress-bar",20)}function A(n,s){1&n&&(t.TgZ(0,"th",21),t._uU(1," Nome "),t.qZA())}function M(n,s){if(1&n&&(t.TgZ(0,"td",22),t._uU(1),t.qZA()),2&n){const a=s.$implicit;t.xp6(1),t.hij(" ",a.name," ")}}function w(n,s){1&n&&t._UZ(0,"th",23)}function O(n,s){if(1&n){const a=t.EpF();t.TgZ(0,"td",22)(1,"div",24)(2,"button",25),t.NdJ("click",function(){const i=t.CHM(a).$implicit,l=t.oxw();return t.KtG(l.openTaskPlanDialog(i,!0))}),t._UZ(3,"i",26),t.qZA(),t.TgZ(4,"button",27),t.NdJ("click",function(){const i=t.CHM(a).$implicit,l=t.oxw();return t.KtG(l.viewListTasks(i.id))}),t._UZ(5,"i",28),t.qZA(),t.TgZ(6,"button",29),t.NdJ("click",function(){const i=t.CHM(a).$implicit,l=t.oxw();return t.KtG(l.openTaskPlanDialog(i,!1))}),t._UZ(7,"i",30),t.qZA(),t.TgZ(8,"button",31),t.NdJ("click",function(){const i=t.CHM(a).$implicit,l=t.oxw();return t.KtG(l.delete(i.id))}),t._UZ(9,"i",32),t.qZA()()()}}function Y(n,s){1&n&&t._UZ(0,"tr",33)}function L(n,s){1&n&&t._UZ(0,"tr",34)}const N=function(){return[25,50,100]};function J(n,s){1&n&&t._UZ(0,"mat-progress-bar",10)}function I(n,s){if(1&n){const a=t.EpF();t.TgZ(0,"div",11)(1,"input",12),t.NdJ("change",function(o){const l=t.CHM(a).$implicit,m=t.oxw();return t.KtG(m.handleCheckboxClick(o,l.id))}),t.qZA(),t.TgZ(2,"div")(3,"span",13),t._uU(4),t.qZA()()()}if(2&n){const a=s.$implicit,e=t.oxw();t.xp6(1),t.Q6J("checked",e.isTaskSelected(a.id)),t.xp6(3),t.Oqu(a.name)}}const R=[{path:"",component:(()=>{class n{constructor(a,e,o,i,l,m){this._liveAnnouncer=a,this.dialog=e,this._snackBar=o,this.router=i,this.dialogService=l,this.tasksPlanResource=m,this.loading=!1,this.tasksPlan=[],this.displayedColumns=["name","options"],this.dataSource=new c.by}ngOnInit(){this.downloadTasksPlan()}ngAfterViewInit(){this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator}applyFilter(a){this.dataSource.filter=a.target.value.trim().toLowerCase()}sortChange(a){this._liveAnnouncer.announce(a.direction?`Sorted ${a.direction}ending`:"Sorting cleared")}openTaskPlanDialog(a,e){null==a&&(e=!1),console.log("copy dialog",e),this.dialog.open(C,{width:"600px",maxHeight:"100vh",panelClass:"dialog",autoFocus:!1,data:{taskPlan:a,copy:e}}).afterClosed().subscribe(i=>{i&&this.downloadTasksPlan()})}downloadTasksPlan(){this.loading=!0,this.tasksPlanResource.list().then(a=>{this.dataSource.data=a,this.tasksPlan=a}).catch(a=>{this.openSnackBar("Erro ao listar","Fechar","danger")}).finally(()=>{this.loading=!1})}delete(a){this.dialogService.openConfirmDialog("Excluir","Tem certeza que deseja excluir?").afterClosed().subscribe(e=>{e&&(this.loading=!0,this.tasksPlanResource.delete(a).then(()=>{this.downloadTasksPlan(),this.openSnackBar("Exclu\xeddo com sucesso!","Fechar","success")}).catch(o=>{this.openSnackBar("Erro ao excluir","Fechar","danger")}).finally(()=>{this.loading=!1}))})}openSnackBar(a,e,o){this._snackBar.open(a,e,{horizontalPosition:"right",verticalPosition:"bottom",duration:3e3,panelClass:"snackBar-"+o})}viewListTasks(a){this.router.navigateByUrl("tasks-plan/"+a)}}return n.\u0275fac=function(a){return new(a||n)(t.Y36(F.Kd),t.Y36(u.uw),t.Y36(f.ux),t.Y36(h.F0),t.Y36(D.x),t.Y36(k.X))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-task-plan-list"]],viewQuery:function(a,e){if(1&a&&(t.Gf(x.NW,5),t.Gf(g.YE,5)),2&a){let o;t.iGM(o=t.CRH())&&(e.paginator=o.first),t.iGM(o=t.CRH())&&(e.sort=o.first)}},decls:27,vars:6,consts:[["id","main",1,"main"],[1,"pagetitle"],[1,"border-loading"],["style","height: 3px; border-radius: 50px","color","accent","mode","indeterminate",4,"ngIf"],[1,"header-table"],[1,"d-flex","align-items-center","justify-content-between"],[1,"search_input_group","search-table","w-25","mt-4","mb-4"],[1,"mdi","mdi-magnify"],["matInput","","placeholder","Pesquisar",1,"search_input",3,"input"],["input",""],["mat-stroked-button","","type","button",1,"button-add",3,"click"],["mat-table","","matSort","",3,"dataSource","matSortChange"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","options"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"mat-paginator",3,"pageSizeOptions"],["color","accent","mode","indeterminate",2,"height","3px","border-radius","50px"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell",""],[1,"mat-icon-no-color"],["matTooltip","Duplicar",1,"icons-options",3,"click"],[1,"mdi","mdi-content-copy"],["matTooltip","Listar Tarefas",1,"icons-options",3,"click"],[1,"mdi","mdi-login"],["matTooltip","Editar",1,"icons-options",3,"click"],[1,"mdi","mdi-square-edit-outline"],["matTooltip","Excluir",1,"icons-options",3,"click"],[1,"mdi","mdi-trash-can-outline"],["mat-header-row",""],["mat-row",""]],template:function(a,e){1&a&&(t.TgZ(0,"main",0)(1,"div",1)(2,"h1"),t._uU(3,"Plano de Tarefas"),t.qZA()(),t.TgZ(4,"div",2),t.YNc(5,S,1,0,"mat-progress-bar",3),t.qZA(),t.TgZ(6,"div",4)(7,"div",5)(8,"div",6),t._UZ(9,"i",7),t._uU(10,"\xa0 "),t.TgZ(11,"input",8,9),t.NdJ("input",function(i){return e.applyFilter(i)}),t.qZA()(),t.TgZ(13,"div")(14,"button",10),t.NdJ("click",function(){return e.openTaskPlanDialog()}),t._uU(15,"Adicionar"),t.qZA()()(),t.TgZ(16,"div")(17,"table",11),t.NdJ("matSortChange",function(i){return e.sortChange(i)}),t.ynx(18,12),t.YNc(19,A,2,0,"th",13),t.YNc(20,M,2,1,"td",14),t.BQk(),t.ynx(21,15),t.YNc(22,w,1,0,"th",16),t.YNc(23,O,10,0,"td",14),t.BQk(),t.YNc(24,Y,1,0,"tr",17),t.YNc(25,L,1,0,"tr",18),t.qZA(),t._UZ(26,"mat-paginator",19),t.qZA()()()),2&a&&(t.xp6(5),t.Q6J("ngIf",e.loading),t.xp6(12),t.Q6J("dataSource",e.dataSource),t.xp6(7),t.Q6J("matHeaderRowDef",e.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns),t.xp6(1),t.Q6J("pageSizeOptions",t.DdM(5,N)))},dependencies:[p.O5,x.NW,T.pW,g.YE,g.nU,b.lW,y.Nt,B.gM,c.BZ,c.fO,c.as,c.w1,c.Dz,c.nj,c.ge,c.ev,c.XQ,c.Gk],styles:['table[_ngcontent-%COMP%]{width:100%}td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{width:85%}h1[_ngcontent-%COMP%]{margin-top:20px}.button-add[_ngcontent-%COMP%]{border-radius:10px;margin-right:20px;font-size:16px;background-color:#7048ef;color:#fff;display:flex;align-items:center}.mat-header-cell[_ngcontent-%COMP%]{color:#484848;background-color:#f8f7f7;font-size:15px;font-family:TT Commons DemiBold,sans-serif}th.mat-header-cell[_ngcontent-%COMP%]:last-of-type, td.mat-cell[_ngcontent-%COMP%]:last-of-type, td.mat-footer-cell[_ngcontent-%COMP%]:last-of-type{padding-right:0!important}.mdi-magnify[_ngcontent-%COMP%]:before{content:"\\f0349";font-size:smaller}.mat-paginator[_ngcontent-%COMP%]{background-color:#f8f7f7;border-radius:10px}']}),n})()},{path:":id/edit",component:C},{path:"new",component:C},{path:":id",component:(()=>{class n{constructor(a,e,o,i,l){this._snackBar=a,this.taskResource=e,this.taskPlanResource=o,this.router=i,this.formBuilder=l,this.loading=!1,this.selectedTaskIds=[],this.tasks=[],this.tasksPlan=[],this.filteredTasksPlan=[]}ngOnInit(){this.downloadListTasksPlan()}applyFilter(a){const e=a.target.value.trim().toLowerCase();this.filteredTasksPlan=this.tasksPlan.filter(o=>o.name.toLowerCase().includes(e))}initForm(){this.form=this.formBuilder.group({name:[this.nameTaskPlan],tasks:this.formBuilder.array([])})}downloadListTasksPlan(){let a=this.router.snapshot.params.id;this.idTaskPlan=a,this.loading=!0,this.taskPlanResource.show(a).then(e=>{this.nameTaskPlan=e.tasks.name,this.filteredTasksPlan=e.tasks,this.tasksPlan=e.tasks,this.initForm()}).catch(e=>{this.openSnackBar("Erro ao listar","Fechar","danger")}).finally(()=>{this.loading=!1})}handleCheckboxClick(a,e){a.target.checked?this.selectedTaskIds.push(e):this.selectedTaskIds=this.selectedTaskIds.filter(o=>o!==e),this.save()}isTaskSelected(a){return this.selectedTaskIds.includes(a)}save(){if(this.form.valid){this.loading=!0;let a=this.form.value;a.tasks=this.selectedTaskIds,this.idTaskPlan&&this.taskPlanResource.update(this.idTaskPlan,a).then(e=>{this.openSnackBar("Salvo com sucesso!","Fechar","success")}).catch(e=>{this.openSnackBar("Erro ao salvar","Fechar","danger")}).finally(()=>{this.loading=!1})}}openSnackBar(a,e,o){this._snackBar.open(a,e,{horizontalPosition:"right",verticalPosition:"bottom",duration:3e3,panelClass:"snackBar-"+o})}}return n.\u0275fac=function(a){return new(a||n)(t.Y36(f.ux),t.Y36(v.x),t.Y36(k.X),t.Y36(h.gz),t.Y36(d.qu))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-task-plan-detailed"]],decls:13,vars:2,consts:[["id","main",1,"main"],[1,"d-flex","justify-content-between",2,"margin-bottom","-20px"],[1,"pagetitle"],[1,"search_input_group","w-25","mt-3",2,"height","40px"],[1,"mdi","mdi-magnify"],["matInput","","placeholder","Pesquisar",1,"search_input",3,"input"],["input",""],[1,"border-loading","mb-4"],["style","height: 3px; border-radius: 50px","color","accent","mode","indeterminate",4,"ngIf"],["class","event-task",4,"ngFor","ngForOf"],["color","accent","mode","indeterminate",2,"height","3px","border-radius","50px"],[1,"event-task"],["type","checkbox",1,"me-3","size-checkbox",3,"checked","change"],[1,"d-flex"]],template:function(a,e){1&a&&(t.TgZ(0,"main",0)(1,"div",1)(2,"div",2)(3,"h1"),t._uU(4,"Lista de Tarefas"),t.qZA()(),t.TgZ(5,"div",3),t._UZ(6,"i",4),t._uU(7,"\xa0 "),t.TgZ(8,"input",5,6),t.NdJ("input",function(i){return e.applyFilter(i)}),t.qZA()()(),t.TgZ(10,"div",7),t.YNc(11,J,1,0,"mat-progress-bar",8),t.qZA(),t.YNc(12,I,5,2,"div",9),t.qZA()),2&a&&(t.xp6(11),t.Q6J("ngIf",e.loading),t.xp6(1),t.Q6J("ngForOf",e.filteredTasksPlan))},dependencies:[p.sg,p.O5,T.pW,y.Nt],styles:["h1[_ngcontent-%COMP%]{margin-top:20px}.event-task[_ngcontent-%COMP%]{border:dashed 1px #CED4DA;min-height:40px;box-shadow:0 0 30px #0129700d;border-radius:10px;display:flex;align-items:center;padding:15px;margin-top:10px;transition:.5s;border-left:6px solid #9696ff}.size-checkbox[_ngcontent-%COMP%]{height:17px;width:17px;accent-color:#7048EF;cursor:pointer}"]}),n})()}];let E=(()=>{class n{}return n.\u0275fac=function(a){return new(a||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[h.Bz.forChild(R),h.Bz]}),n})();var z=r(1108);let Q=(()=>{class n{}return n.\u0275fac=function(a){return new(a||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[p.ez,E,z.m,P._t]}),n})()}}]);