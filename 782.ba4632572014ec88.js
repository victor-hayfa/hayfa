"use strict";(self.webpackChunkhayfa=self.webpackChunkhayfa||[]).push([[782],{5782:(L,f,r)=>{r.r(f),r.d(f,{KanbanModule:()=>J});var c=r(6895),h=r(1635),d=r(4006),m=r(5412),t=r(4650),b=r(2583),x=r(7009),v=r(3162),_=r(4859),g=r(1206);function k(a,s){1&a&&t._UZ(0,"mat-progress-bar",11)}let u=(()=>{class a{constructor(e,n,o,i,l){this.stageKanbanResource=e,this._snackBar=n,this.formBuilder=o,this.dialog=i,this.data=l,this.loading=!1,this.savedChange=!1,this.stageKanban=this.data.stageKanban}ngOnInit(){this.initForm(),this.populateForm(this.stageKanban)}initForm(){this.form=this.formBuilder.group({name:[null,d.kI.required],status:[!0]})}save(e){if(this.form.valid){this.loading=!0;let n=this.form.value;this.stageKanban?this.stageKanbanResource.update(this.stageKanban.id,n).then(o=>{this.stageKanban=o,this.savedChange=!0,this.openSnackBar("Salvo com sucesso!","Fechar","success"),e&&this.closeDialog()}).catch(o=>{this.openSnackBar("Erro ao salvar","Fechar","danger")}).finally(()=>{this.loading=!1}):this.stageKanbanResource.create(n).then(o=>{this.stageKanban=o,this.savedChange=!0,this.openSnackBar("Salvo com sucesso!","Fechar","success"),e&&this.closeDialog()}).catch(o=>{this.openSnackBar("Erro ao salvar","Fechar","danger")}).finally(()=>{this.loading=!1})}}populateForm(e){this.form.patchValue(e)}closeDialog(){this.savedChange?this.dialog.close(this.stageKanban):this.dialog.close()}canSave(){return this.form.valid&&!this.loading}openSnackBar(e,n,o){this._snackBar.open(e,n,{horizontalPosition:"right",verticalPosition:"bottom",duration:3e3,panelClass:"snackBar-"+o})}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(b.C),t.Y36(x.ux),t.Y36(d.qu),t.Y36(m.so),t.Y36(m.WI))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-kanban-form"]],decls:15,vars:4,consts:[["enctype","multipart/form-data",3,"formGroup"],[1,"btn-close",3,"click"],["mat-dialog-title","","cdkDrag","","cdkDragRootElement",".cdk-overlay-pane","cdkDragHandle","",1,"dialog-header"],["mode","indeterminate",4,"ngIf"],[1,"dialog-body"],[1,"mb-3","col-md-12"],[1,"form-label"],[2,"color","#EC0606DD"],["type","text","formControlName","name",1,"form-control"],[1,"dialog-footer"],["type","submit","mat-button","",1,"btn-save",3,"disabled","click"],["mode","indeterminate"]],template:function(e,n){1&e&&(t.TgZ(0,"form",0)(1,"div",1),t.NdJ("click",function(){return n.closeDialog()}),t.qZA(),t.TgZ(2,"div",2),t._uU(3),t.qZA(),t.YNc(4,k,1,0,"mat-progress-bar",3),t.TgZ(5,"div",4)(6,"div",5)(7,"label",6),t._uU(8,"Nome do Kanban"),t.qZA(),t.TgZ(9,"span",7),t._uU(10," * "),t.qZA(),t._UZ(11,"input",8),t.qZA()(),t.TgZ(12,"div",9)(13,"button",10),t.NdJ("click",function(){return n.save(!0)}),t._uU(14,"Adicionar"),t.qZA()()()),2&e&&(t.Q6J("formGroup",n.form),t.xp6(3),t.Oqu(n.stageKanban?"Editar Kanban":"Novo Kanban"),t.xp6(1),t.Q6J("ngIf",n.loading),t.xp6(9),t.Q6J("disabled",!n.canSave()))},dependencies:[c.O5,v.pW,_.lW,d._Y,d.Fj,d.JJ,d.JL,d.sg,d.u,m.uh,g.Zt,g.Bh],styles:[".dialog-header[_ngcontent-%COMP%]{font-weight:400;font-size:18px;width:auto;border-bottom:1px solid #d9d9d9;padding:10px 15px;background-color:#f8f7f7;margin-bottom:0;height:50px;cursor:grab}.dialog-body[_ngcontent-%COMP%]{padding:20px;height:120px}.dialog-footer[_ngcontent-%COMP%]{border-top:1px solid #d9d9d9;background-color:#f8f7f7;height:60px}.btn-close[_ngcontent-%COMP%]{float:right;font-size:30px;margin-top:2px}"]}),a})();var K=r(4409),Z=r(3886),y=r(4868),F=r(4144),T=r(266),C=r(3546);function M(a,s){1&a&&t._UZ(0,"mat-progress-bar",15)}const D=function(a){return{backgroundColor:a}};function O(a,s){if(1&a&&(t.TgZ(0,"div",34),t._uU(1),t.qZA()),2&a){const e=s.$implicit;t.Q6J("matTooltip",e.user.name)("ngStyle",t.VKq(3,D,e.user.color)),t.xp6(1),t.hij(" ",e.user.name[0]," ")}}function w(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"div",22)(1,"div",23)(2,"div",24)(3,"span",25),t._uU(4),t.qZA(),t.TgZ(5,"i",26),t.NdJ("click",function(){const i=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.openNewEventDialog(i))}),t.qZA(),t.TgZ(6,"button",27),t.NdJ("click",function(){const i=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.viewEventsDetails(i.id))}),t._uU(7," Ver mais "),t.qZA()(),t.TgZ(8,"span",28),t._uU(9),t.qZA(),t.TgZ(10,"div",29)(11,"span",30),t._uU(12),t.qZA()(),t.TgZ(13,"div",24),t.YNc(14,O,2,5,"div",31),t.qZA(),t.TgZ(15,"div",32)(16,"div",33),t._uU(17),t.qZA()()()()}if(2&a){const e=s.$implicit,n=t.oxw(2);t.Q6J("cdkDragData",e),t.xp6(4),t.Oqu(e.name),t.xp6(5),t.hij("Local do Evento: ",e.local.name,""),t.xp6(3),t.AsE(" ",n.formatDate(e.date_event)," ",n.formatHour(e.hour_event)," "),t.xp6(2),t.Q6J("ngForOf",n.tasksEvent),t.xp6(2),t.Udp("width",e.percentage>0?e.percentage:100,"%"),t.Q6J("ngClass",e.percentage>0?"progress-bar":"not-progress-bar"),t.xp6(1),t.hij(" ",e.percentage>0?e.percentage+"%":"0%"," ")}}function S(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"mat-card",16),t.NdJ("cdkDropListDropped",function(o){const l=t.CHM(e).$implicit,p=t.oxw();return t.KtG(p.drop(o,l.id))}),t.TgZ(1,"div",17)(2,"mat-card-content",18),t._uU(3),t.qZA(),t.TgZ(4,"div")(5,"i",19),t.NdJ("click",function(){const i=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.openDialogStageKanban(i))}),t.qZA(),t.TgZ(6,"i",20),t.NdJ("click",function(){const i=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.delete(i.id))}),t.qZA()()(),t.TgZ(7,"div"),t.YNc(8,w,18,10,"div",21),t.qZA()()}if(2&a){const e=s.$implicit,n=t.oxw();t.Q6J("id",n.convertId(e.id)),t.xp6(3),t.Oqu(e.name),t.xp6(5),t.Q6J("ngForOf",e.events)}}const E=[{path:"",component:(()=>{class a{constructor(e,n,o,i,l,p){this.dialog=e,this.router=n,this.stageKanbanResource=o,this.eventResource=i,this._snackBar=l,this.dialogService=p,this.loading=!1,this.stageKanban=[],this.filteredStageEvents=[],this.events=[],this.tasksEvent=[]}ngOnInit(){this.downloadStageKanban(),this.downloadEvents()}applyFilter(e){const n=e.target.value.trim().toLowerCase();this.filteredStageEvents=this.stageKanban.filter(o=>o.name.toLowerCase().includes(n))}viewEventsDetails(e){this.router.navigateByUrl("events/"+e)}downloadStageKanban(){this.loading=!0,this.stageKanbanResource.list().then(e=>{this.stageKanban=e,e.forEach(n=>{this.filteredStageEvents=n.events})}).catch(e=>{this.openSnackBar("Erro ao listar","Fechar","danger")}).finally(()=>{this.loading=!1})}formatDate(e){let n=new Date(e),i=["Janeiro","Fevereiro","Mar\xe7o","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"][n.getMonth()];return`${n.getDate()} de ${i}, ${n.getFullYear()}`}formatHour(e){let n=e.split(":");return`${n[0]}:${n[1]}`}openDialogStageKanban(e){this.dialog.open(u,{width:"500px",maxHeight:"100vh",panelClass:"dialog",autoFocus:!1,data:{stageKanban:e}}).afterClosed().subscribe(o=>{o&&this.downloadStageKanban()})}openSnackBar(e,n,o){this._snackBar.open(e,n,{horizontalPosition:"right",verticalPosition:"bottom",duration:3e3,panelClass:"snackBar-"+o})}openNewEventDialog(e){this.dialog.open(K.A,{panelClass:"dialog",autoFocus:!1,width:"850px",maxHeight:"100vh",data:{event:e}}).afterClosed().subscribe(o=>{o&&this.downloadEvents()})}downloadEvents(){this.loading=!0,this.eventResource.list().then(e=>{this.events=e,this.events.forEach(n=>{this.tasksEvent=n.tasks})}).catch(e=>{this.openSnackBar("Erro ao listar","Fechar","danger")}).finally(()=>{this.loading=!1})}delete(e){this.dialogService.openConfirmDialog("Excluir","Tem certeza que deseja excluir?").afterClosed().subscribe(n=>{n&&(this.loading=!0,this.stageKanbanResource.delete(e).then(()=>{this.downloadStageKanban(),this.openSnackBar("Exclu\xeddo com sucesso!","Fechar","success")}).catch(o=>{this.openSnackBar("Erro ao excluir Kanban","Fechar","danger")}).finally(()=>{this.loading=!1}))})}drop(e,n){this.loading=!0,this.eventResource.update(e.item.data.id,{stage_id:n}).then(l=>{this.downloadStageKanban()}).catch(l=>{this.openSnackBar("Erro drag and drop","Fechar","danger")}).finally(()=>{this.loading=!1})}convertId(e){return String(e)}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(m.uw),t.Y36(h.F0),t.Y36(b.C),t.Y36(Z.U),t.Y36(x.ux),t.Y36(y.x))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-kanban-list"]],decls:19,vars:2,consts:[["id","main",1,"main"],[1,"d-flex","justify-content-between"],[1,"pagetitle"],[1,"search_input_group","w-25","mt-3",2,"height","40px"],[1,"mdi","mdi-magnify"],["matInput","","placeholder","Pesquisar",1,"search_input",3,"input"],["input",""],[1,"border-loading"],["style","height: 3px; border-radius: 50px","color","accent","mode","indeterminate",4,"ngIf"],[1,"mt-3","mb-3","mx-3"],["mat-stroked-button","",1,"d-flex","align-items-center",2,"color","#7048ef","height","30px",3,"click"],[1,"mdi","mdi-plus"],[1,"row","h-100","card-container"],["cdkDropListGroup","",1,"d-flex"],["class","mat-card-custom card","cdkDropList","",3,"id","cdkDropListDropped",4,"ngFor","ngForOf"],["color","accent","mode","indeterminate",2,"height","3px","border-radius","50px"],["cdkDropList","",1,"mat-card-custom","card",3,"id","cdkDropListDropped"],[1,"d-flex","align-items-baseline","justify-content-between"],[1,"title-kanban"],[1,"mdi","mdi-pencil","icon-edit","mx-2",3,"click"],[1,"mdi","mdi-delete","icon-delete",3,"click"],["cdkDrag","",3,"cdkDragData",4,"ngFor","ngForOf"],["cdkDrag","",3,"cdkDragData"],[1,"kanban","p-3"],[1,"d-flex","align-items-center"],[1,"person-event"],[1,"mdi","mdi-square-edit-outline","mx-2","icon-edit",3,"click"],["mat-stroked-button","",1,"d-flex","align-items-center",2,"height","30px","margin-left","auto",3,"click"],[1,"local-event"],[1,"date-kanban-tasks"],[1,"d-flex","align-items-center","justify-content-center",2,"margin-left","10px"],["class","d-flex avatar size-avatar mx-1 mt-3",3,"matTooltip","ngStyle",4,"ngFor","ngForOf"],[1,"progress","mt-3","mb-2"],["role","progressbar",2,"font-size","14px","font-weight","bold",3,"ngClass"],[1,"d-flex","avatar","size-avatar","mx-1","mt-3",3,"matTooltip","ngStyle"]],template:function(e,n){1&e&&(t.TgZ(0,"main",0)(1,"div",1)(2,"div",2)(3,"h1"),t._uU(4,"Kanban"),t.qZA()(),t.TgZ(5,"div",3),t._UZ(6,"i",4),t._uU(7,"\xa0 "),t.TgZ(8,"input",5,6),t.NdJ("input",function(i){return n.applyFilter(i)}),t.qZA()()(),t.TgZ(10,"div",7),t.YNc(11,M,1,0,"mat-progress-bar",8),t.qZA(),t.TgZ(12,"div",9)(13,"button",10),t.NdJ("click",function(){return n.openDialogStageKanban()}),t._UZ(14,"i",11),t._uU(15," Adicionar "),t.qZA()(),t.TgZ(16,"div",12)(17,"div",13),t.YNc(18,S,9,3,"mat-card",14),t.qZA()()()),2&e&&(t.xp6(11),t.Q6J("ngIf",n.loading),t.xp6(7),t.Q6J("ngForOf",n.stageKanban))},dependencies:[c.mk,c.sg,c.O5,c.PC,v.pW,_.lW,F.Nt,T.gM,C.a8,C.dn,g.Wj,g.Fd,g.Zt],styles:["h1[_ngcontent-%COMP%]{margin-top:20px}.border-loading[_ngcontent-%COMP%]{border-top:1px solid #d7d7d7;margin-top:20px}.kanban[_ngcontent-%COMP%]{background:#FFFFFF;border:1px solid #E7E7E7;border-radius:15px;margin-bottom:10px;cursor:move}.users-kanban-tasks[_ngcontent-%COMP%]{box-sizing:border-box;position:relative;width:30px;height:29px;background:rgba(231,231,231,.5);border:1px solid rgba(127,127,127,.5);border-radius:30px;margin-top:15px;margin-right:5px}.date-kanban-tasks[_ngcontent-%COMP%]{height:30px;font-style:normal;font-weight:600;font-size:14px;line-height:22px;display:flex;align-items:center;color:#242424;margin-top:10px;background:rgba(244,243,243,.05);border:1px solid rgba(127,127,127,.5);border-radius:5px}.person-event[_ngcontent-%COMP%]{font-style:normal;font-weight:600;font-size:16px;line-height:29px;color:#242424}.step-tasks[_ngcontent-%COMP%]{font-style:normal;font-weight:500;font-size:14px;line-height:22px;display:flex;align-items:center;color:#242424b3}.local-event[_ngcontent-%COMP%]{font-style:italic;font-weight:500;font-size:14px;line-height:22px;display:flex;align-items:center;color:#242424b3}.title-kanban[_ngcontent-%COMP%]{font-style:normal;font-weight:600;font-size:18px;line-height:29px;display:flex;align-items:center;color:#242424;margin-left:10px}.add-tasks-kanban[_ngcontent-%COMP%]{width:38px;height:37px;background:rgba(101,136,226,.15);border-radius:30px;margin-bottom:15px;margin-right:10px}.mat-card-custom[_ngcontent-%COMP%]{background-color:#f4f3f3;margin-left:13px;height:auto;overflow-y:scroll}  .progress{display:flex;height:1.2rem;overflow:hidden;font-size:13rem;background-color:#e9ecef;border-radius:.35rem}.card-container[_ngcontent-%COMP%]{display:flex;overflow-x:auto;width:100%;white-space:nowrap}.card[_ngcontent-%COMP%]{flex-shrink:0;width:30%}.border-loading[_ngcontent-%COMP%]{border-top:1px solid #e7e7e7;margin-top:1px;border-radius:50px}.icon-edit[_ngcontent-%COMP%]{color:#6e6e6e;cursor:pointer}.icon-edit[_ngcontent-%COMP%]:hover{color:#000}.icon-delete[_ngcontent-%COMP%]{color:#6e6e6e;cursor:pointer}.icon-delete[_ngcontent-%COMP%]:hover{color:#ec0606dd}.not-progress-bar[_ngcontent-%COMP%]{font-weight:700;color:#242424;display:flex;justify-content:center;align-items:center}.cdk-drag-preview[_ngcontent-%COMP%]{border:none;border-radius:15px;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f;font-family:TT Commons Regular,serif!important}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.size-avatar[_ngcontent-%COMP%]{width:28px;height:28px;font-size:15px}"]}),a})()},{path:"new",component:u},{path:":id/edit",component:u}];let P=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[h.Bz.forChild(E),h.Bz]}),a})();var A=r(1108);let J=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[c.ez,P,A.m,g._t]}),a})()}}]);